# -*-  coding: utf-8 -*-
"""
Each method run 50,000 times:

version_read     : 4.43451 sec
version_store    : 4.46381 sec 1.01x slower
big_data_read    : 5.09727 sec 1.15x slower
big_data_store   : 5.49166 sec 1.24x slower

"""

# Copyright (C) 2015 ZetaOps Inc.
#
# This file is licensed under the GNU General Public License v3
# (GPLv3).  See LICENSE.txt for details.
from ztimer import Timer, K
import redis

r = redis.Redis()
data = '''[{"fname":"Steve","lname":"Pacheco","tel":"(968)304-3752",
"address":"6366 Massa Ave","city":"Louisville","state":"MA","zip":85131},
{"fname":"Cory","lname":"Womack","tel":"(277)537-0357","address":
"5592 Scelerisque Rd","city":"Wilmington","state":"AK","zip":80707},{"fname":
"Farhad","lname":"Clinger","tel":"(521)067-9748","address":"490 Adipiscing Rd"
,"city":"Cape Coral","state":"FL","zip":33711},{"fname":"Kathryn","lname":
"Garascia","tel":"(879)897-2395","address":"3953 Turpis Dr","city":"Delray",
"state":"RI","zip":20313},{"fname":"Rosalinda","lname":"Pace","tel":"(451)613-
7322","address":"6920 Orci Rd","city":"Saint Ann","state":"WV","zip":29818},
{"fname":"Rena","lname":"Gerhard","tel":"(955)240-9404","address":"3048 Sed Rd"
,"city":"E. Lansing","state":"ME","zip":82882},{"fname":"Angelique","lname":"Goodman","tel":"(179)317-8985","address":"5355 Placerat Rd","city":"Arvada","state":"OH","zip":48295},{"fname":"Sally","lname":"Oconnor","tel":"(622)224-9158","address":"4069 Porttitor Dr","city":"Rio Rancho","state":"AZ","zip":83242},{"fname":"Usha","lname":"Frutos","tel":"(110)822-8678","address":"8230 Tortor Ave","city":"Georgetown","state":"WY","zip":50550},{"fname":"Herman","lname":"Zazzara","tel":"(738)358-6695","address":"3707 Vestibulum Dr","city":"Superior","state":"HI","zip":23515},{"fname":"Leilani","lname":"Clanton","tel":"(846)346-2147","address":"6997 Aenean Ln","city":"Curtis Bay","state":"MA","zip":40357},{"fname":"Elba","lname":"Ruback","tel":"(612)452-9597","address":"1262 Tincidunt Dr","city":"Rockville","state":"NH","zip":38472},{"fname":"Carl","lname":"Akins","tel":"(121)127-5051","address":"6935 Eget St","city":"Hampstead","state":"MN","zip":15214},{"fname":"Olivia","lname":"Mcgarity","tel":"(645)393-3532","address":"8073 Aliquam Ct","city":"Riverside","state":"SC","zip":56593},{"fname":"Francis","lname":"Owlett","tel":"(542)422-5066","address":"416 Malesuada Ct","city":"Fort Worth","state":"GA","zip":79712},{"fname":"Tasha","lname":"Blackburn","tel":"(611)605-0445","address":"7788 Aenean Dr","city":"Bradford","state":"ME","zip":72385},{"fname":"Wei","lname":"Raslich","tel":"(242)915-6446","address":"7433 Risus Rd","city":"Leesburg","state":"NC","zip":21157},{"fname":"Rosemary","lname":"Marina","tel":"(741)063-0030","address":"9486 Dolor Rd","city":"Santa Monica","state":"AZ","zip":23190},{"fname":"Nitin","lname":"Kamdar","tel":"(925)873-7925","address":"4496 Adipiscing Ln","city":"Wichita","state":"NC","zip":78446},{"fname":"Clarence","lname":"Pilgrim","tel":"(208)389-5205","address":"6320 Adipiscing Rd","city":"Montreal","state":"MT","zip":94969},{"fname":"Hathor","lname":"Kachelmuss","tel":"(935)019-9274","address":"7029 Mi Ave","city":"Virginia Beach","state":"WI","zip":20375},{"fname":"Suwanto","lname":"Carlsen","tel":"(725)069-1570","address":"9966 At Ct","city":"Rapid City","state":"TN","zip":88148},{"fname":"Syed","lname":"Traficante","tel":"(216)617-1566","address":"9106 Malesuada Dr","city":"Coeur D'alene","state":"NH","zip":88196},{"fname":"Polina","lname":"Kubota","tel":"(196)658-0447","address":"5278 At Rd","city":"Blaine","state":"AZ","zip":39307},{"fname":"Devon","lname":"Gay","tel":"(518)688-6389","address":"7841 Sagittis Ln","city":"Temecula","state":"NC","zip":22476},{"fname":"Joy","lname":"Brouillette","tel":"(380)597-5983","address":"818 Sed Ave","city":"Pittsburgh","state":"WY","zip":47682},{"fname":"Willie","lname":"Kelley","tel":"(783)534-0571","address":"2341 Adipiscing Rd","city":"Paw Paw","state":"MS","zip":92110},{"fname":"Lisbeth","lname":"Mel","tel":"(418)674-4346","address":"1916 Consequat Ln","city":"Bellefonte","state":"MI","zip":36171},{"fname":"Dante","lname":"Aubut","tel":"(518)195-9557","address":"1537 Nec Dr","city":"Orange County","state":"NE","zip":45286},{"fname":"Ben","lname":"Reinhard","tel":"(186)415-4154","address":"1530 Magna St","city":"Lewiston","state":"NJ","zip":38901},{"fname":"Araceli","lname":"Romero","tel":"(144)791-0861","address":"2537 Pharetra Ave","city":"Schaumburg","state":"HI","zip":85583},{"fname":"Gabrielle","lname":"Hobbs","tel":"(196)562-1501","address":"6172 Et Ct","city":"Texas City","state":"DE","zip":77845},{"fname":"Bettye","lname":"Dobbins","tel":"(557)265-1486","address":"5660 Sollicitudin Ave","city":"Lafayette","state":"GA","zip":86941},{"fname":"Wazir","lname":"Grunert","tel":"(271)641-6195","address":"8639 Mi Ct","city":"Rancho Cordova","state":"AR","zip":63418},{"fname":"Charles","lname":"Federico","tel":"(370)654-3873","address":"8181 Sit Ln","city":"Lake In The Hills","state":"RI","zip":19035},{"fname":"Bob","lname":"Park","tel":"(845)361-1483","address":"3286 Sit St","city":"Westwood","state":"UT","zip":85327},{"fname":"Cory","lname":"Forenda","tel":"(733)880-0095","address":"3240 Curabitur Ave","city":"Woonsocket","state":"MO","zip":28748},{"fname":"Evelyn","lname":"Kailin","tel":"(513)063-8576","address":"2012 Risus Ln","city":"Inez","state":"AZ","zip":57796},{"fname":"Letisha","lname":"Schwier","tel":"(842)778-3952","address":"2479 Lectus Dr","city":"Denton","state":"WV","zip":97170},{"fname":"Charisse","lname":"Mullins","tel":"(244)577-8045","address":"795 Pretium Dr","city":"Topeka","state":"UT","zip":10879},{"fname":"Karita","lname":"Newby","tel":"(228)599-3791","address":"445 Vestibulum Ave","city":"Wahiawa","state":"HI","zip":15062},{"fname":"Bob","lname":"Santos","tel":"(975)489-5540","address":"753 Pulvinar Dr","city":"Rio Rancho","state":"TX","zip":64472},{"fname":"Minxue","lname":"Davidson","tel":"(578)952-3747","address":"1235 Aenean Rd","city":"Arlington","state":"MI","zip":83797},{"fname":"Leovigildo","lname":"Martinez","tel":"(581)135-1780","address":"9762 Ante Ave","city":"Topeka","state":"AR","zip":82803},{"fname":"Maureen","lname":"Mazza","tel":"(442)377-0308","address":"5748 Magna Ln","city":"Johnson County","state":"IA","zip":61118},{"fname":"Regina","lname":"Earls","tel":"(757)373-1222","address":"2420 Curabitur St","city":"Cambridge","state":"KY","zip":95471},{"fname":"Dedun","lname":"Berin","tel":"(652)088-4005","address":"9578 Magna Ave","city":"Litchfield Park","state":"HI","zip":89433},{"fname":"Nikko","lname":"Hohmann","tel":"(295)271-2906","address":"5950 Tellus Ln","city":"Fort Myers","state":"NJ","zip":57393},{"fname":"Terrence","lname":"Buxton","tel":"(434)332-4117","address":"2636 Orci St","city":"Piedmont","state":"ME","zip":72467},{"fname":"Guadelupe","lname":"Pritchard","tel":"(735)010-2723","address":"2406 Lacus Ln","city":"Charlotte","state":"OH","zip":10136},{"fname":"Randy","lname":"Kirkley","tel":"(988)495-7065","address":"5917 Pulvinar Ct","city":"Durham","state":"WA","zip":13684},{"fname":"Demetrius","lname":"Rogers","tel":"(964)738-5043","address":"2627 Et Ave","city":"Jacksonville","state":"LA","zip":29583},{"fname":"Tom","lname":"Hydle","tel":"(886)973-6248","address":"8827 Sit Ct","city":"San Francisco","state":"LA","zip":93198},{"fname":"Ginger","lname":"Gerver","tel":"(508)931-3047","address":"3331 Eget Ln","city":"Pacoima","state":"NY","zip":80997},{"fname":"Yu","lname":"Swayngim","tel":"(181)683-2245","address":"7846 Sagittis Dr","city":"Pacoima","state":"CA","zip":87136},{"fname":"Colette","lname":"Gardana","tel":"(661)209-6317","address":"5853 Magna Ave","city":"Newburg","state":"OR","zip":47112},{"fname":"Vinit","lname":"Hale","tel":"(530)119-7115","address":"9888 Sollicitudin Ct","city":"Florissant","state":"UT","zip":12740},{"fname":"Darwin","lname":"Dykstra","tel":"(481)493-0815","address":"9207 Nullam Rd","city":"Coon Rapids","state":"MO","zip":17207},{"fname":"Yeqing","lname":"Kieser","tel":"(754)579-9630","address":"7965 Placerat Ln","city":"Brodhead","state":"HI","zip":30223},{"fname":"Nakesha","lname":"Wrather","tel":"(650)960-9394","address":"1420 Lectus Rd","city":"Simi Valley","state":"ND","zip":46154},{"fname":"Letisha","lname":"Lowe","tel":"(903)041-8568","address":"2814 Aliquam Ave","city":"Moundridge","state":"SC","zip":36396},{"fname":"Leif","lname":"Lieb","tel":"(777)079-6233","address":"9743 At Dr","city":"Simi Valley","state":"NE","zip":84751},{"fname":"Evelyn","lname":"Kem","tel":"(166)298-6913","address":"1076 Sollicitudin Ave","city":"Temecula","state":"NH","zip":33216},{"fname":"Suanne","lname":"Douglas","tel":"(576)686-2714","address":"8483 Vestibulum Rd","city":"Norfolk","state":"NC","zip":88525},{"fname":"Marilynn","lname":"Polenz","tel":"(657)323-2869","address":"9 Et Ct","city":"Smyrna","state":"VA","zip":66760},{"fname":"Yauma","lname":"Carey","tel":"(240)253-5073","address":"1082 Vestibulum Dr","city":"Swansea","state":"NH","zip":94737},{"fname":"Latonia","lname":"Zazzara","tel":"(594)229-9244","address":"447 Orci Rd","city":"Saucier","state":"MS","zip":93001},{"fname":"Aely","lname":"Belisario","tel":"(936)706-6800","address":"6791 Amet Ln","city":"Berkeley","state":"NC","zip":97533},{"fname":"Dorci'A","lname":"Gorski","tel":"(472)956-9669","address":"5159 Pharetra Rd","city":"Walnut Creek","state":"WA","zip":64742},{"fname":"Segun","lname":"Webster","tel":"(934)034-6510","address":"6282 Lorem Ct","city":"Superior","state":"MD","zip":73060},{"fname":"Kerry","lname":"Love","tel":"(769)872-9572","address":"7765 Sit Ln","city":"Fort Myers","state":"MN","zip":25505},{"fname":"William","lname":"Dinkel","tel":"(494)309-5069","address":"7807 Turpis Dr","city":"Newburg","state":"SD","zip":77945},{"fname":"Stuart","lname":"Scott","tel":"(884)612-4777","address":"6154 Morbi Dr","city":"Blaine","state":"GA","zip":49188},{"fname":"Leslie","lname":"Batrouny","tel":"(168)077-6838","address":"5864 Porta St","city":"Augusta","state":"IA","zip":25721},{"fname":"Aubre","lname":"Rearick","tel":"(541)080-0662","address":"3178 Sagittis Dr","city":"Olive Branch","state":"CT","zip":22236},{"fname":"Aesha","lname":"Mcinvale","tel":"(868)263-7178","address":"7539 Placerat St","city":"Englewood","state":"WV","zip":47906},{"fname":"Mason","lname":"Lenz","tel":"(632)392-7037","address":"4640 Sed Ct","city":"Nashua","state":"ND","zip":16546},{"fname":"Roland","lname":"Mcmenamin","tel":"(380)183-3571","address":"2735 Ante Ct","city":"Smithers","state":"RI","zip":68409},{"fname":"Vernell","lname":"Haynes","tel":"(989)703-8180","address":"2637 Scelerisque Ct","city":"Villa Rica","state":"NV","zip":57455},{"fname":"Pablo","lname":"Peschke","tel":"(896)257-1203","address":"3749 Porta Rd","city":"Arcadia","state":"MN","zip":75474},{"fname":"Tracey","lname":"Eichberger","tel":"(445)912-5912","address":"6284 Tortor Ln","city":"Moulton","state":"NV","zip":21425},{"fname":"Mason","lname":"Ingle","tel":"(147)061-5507","address":"229 Aliquam Ct","city":"Clovis","state":"KY","zip":16071},{"fname":"Halina","lname":"Sueri","tel":"(172)680-5439","address":"5022 Velit Ln","city":"Lynchburg","state":"WA","zip":26203},{"fname":"Rania","lname":"Knoepfel","tel":"(968)571-7761","address":"6718 Molestie Dr","city":"Brighton","state":"OH","zip":93424},{"fname":"Clint","lname":"Gullion","tel":"(242)622-4450","address":"6160 Vitae Rd","city":"Glencoe","state":"NM","zip":76313},{"fname":"Seth","lname":"Schoenbauer","tel":"(835)338-1697","address":"539 Sit Ave","city":"Bessemer City","state":"DC","zip":90169},{"fname":"Ghaffar","lname":"Maurer","tel":"(150)205-3586","address":"2886 Et Ln","city":"Winona Lake","state":"NH","zip":13066},{"fname":"Cavanaugh","lname":"Mason","tel":"(931)272-6513","address":"6899 Augue Ave","city":"Derby","state":"TX","zip":95273},{"fname":"Ernesto","lname":"Vanburen","tel":"(153)614-5664","address":"6716 Augue Ln","city":"Charlotte","state":"RI","zip":16237},{"fname":"Pelagija","lname":"Connor","tel":"(529)858-6267","address":"2666 Pulvinar Ct","city":"Joliet","state":"NC","zip":87879},{"fname":"Gueorgui","lname":"Fergus","tel":"(797)277-2181","address":"5636 In Ln","city":"Pawtucket","state":"NY","zip":11527},{"fname":"Venus","lname":"Ahern","tel":"(812)503-3991","address":"4237 Sed Rd","city":"Hampton","state":"WA","zip":93271},{"fname":"April","lname":"Penning","tel":"(748)825-7827","address":"1012 Donec Ln","city":"Swansea","state":"MA","zip":84348},{"fname":"Jeffery","lname":"Hunt","tel":"(440)700-0457","address":"6520 Sagittis Ave","city":"Wasington Dc","state":"MS","zip":57386},{"fname":"Fritz","lname":"Bright","tel":"(730)063-4270","address":"9909 Molestie Ct","city":"Elizabethtown","state":"WA","zip":15826},{"fname":"Raquel","lname":"Jeschke","tel":"(405)923-4372","address":"5353 Odio St","city":"Snellville","state":"NM","zip":50878},{"fname":"Weili","lname":"Gaby","tel":"(597)794-3486","address":"1143 Magna Ave","city":"North Providence","state":"DE","zip":69598},{"fname":"Shanstella","lname":"Drolet","tel":"(544)875-8324","address":"5519 Et Rd","city":"Anonymous","state":"NC","zip":62336},{"fname":"Amalia","lname":"Wilcox","tel":"(761)812-8183","address":"6643 Massa Ave","city":"Patterson","state":"ID","zip":63850},{"fname":"Iris","lname":"Fielder","tel":"(882)867-7535","address":"7521 Elementum Rd","city":"Pasco","state":"HI","zip":93683}]'''
key = 'a1'
key2 = 'a2'
r.set(key, data)
r.set(key2, '1234')


class Tst(Timer):
    def big_data_store(self):
        r.set(key, data)

    def big_data_read(self):
        r.get(key)

    def version_store(self):
        r.set(key2, '1234')

    def version_read(self):
        r.get(key2)


Tst(50 * K)
